------------------------------------------
セルの設計
------------------------------------------
ID	ルール概要	理由・背景	ルールがない場合のミス	具体的な対応	
1	重要セルには名前を定義する	A1等でセルを指定すると行・列の挿入や並べ替えで参照がずれる可能性がある。名前定義は「そのセル（範囲）の意味」を明示でき、可読性も上昇する。	"列追加で参照セルがずれてしまい、誤集計・誤計算をしてしまう。
VLOOKUPの列番号ずれやSUMの取り漏れが発生し、原因特定に時間を浪費する。"	"・重要セル・範囲に名前を付与する
・重要なセルの判断基準としては、最終結果に与える影響を踏まえ、例えば以下の例が挙げられる。
[中間の計測結果のセル]
[ツール内で何度も参照しているセル]
・命名規則は[役割]_[対象]_[指標]（_[その他]）にする。
●[役割]
in、out、con、param、calc（中間計算結果）
●[対象]
exposure、risk、CreditRate、fx
●[指標]
total、average、max、mean、rate
●[その他]
シナリオ名等
・セルではなく、範囲の場合はrngをつける
・テーブルのばあいはt_をつける"	
2	パラメータや前提の数値を算式内に直接埋め込むのではなく、専用のセルを用意し、それを参照する。	・パラメータが変化した際に、直接埋め込むと更新漏れを招く。		"・「パラメータ」シートを設け、必要なパラメータを入力し、そのセルを参照するようにする。
・上記の重要なセルに相当することが多いので、セルや範囲に名称をつける。"	
3	データ範囲はテーブル化する	"・テーブルは列全体を算式で参照でき、算式で参照する範囲が自動で変化する。そのため、更新漏れ防止になる。
・また、列名で参照できるため、意図が明瞭になり、可読性が上がる。"		"・対象範囲を選択し、Ctrl+Tでテーブル化
・式は=SUM(売上[金額])のように列名で参照する"	
4	表における空白の意味を明示する	"・空白は「ゼロ」「欠損」「対象外」など複数の意味を取り得るが、初見では判別しにくいため、判断を誤らせる可能性がある。
・未入力をゼロとして扱って平均や合計が過小に出たり、対象外を集計に含めて精度を損なってしまう事等が起こりうる。"		・空欄にせずにN/Aや、0、対象外等を記載する。	
5	複雑な算式の場合はセルを分割する	"・セルに複雑な算式を記載すると、検証・修正が困難になる。
・不具合が発生した時の原因追及が困難になる。"		"・以下の場合にセルの内容を分割する。
①関数種類が4個以上になる場合
②階層が4以上になる場合
・算式が複雑になる場合は、LET関数やN関数を使用することも検討する（ルール●●参照）"	
6	フィルタ機能は適用中の明示と解除を行う	・フィルタ適用中は一部データのみで平均・合計を算出し、意図しない計算をしてしまう可能性がある。		"・以下の方法でフィルター適用中であることを明示的にしておく
①subtotal関数・Row関数を使用して、表示行数と表の行数の差異を取る方法
②VBAを使用する方法（appendix●●参照）
・上記のサインがついている場合はフィルターを解除する。必要に応じてappendix●●のVBAを導入し、保存前にフィルターを解除するかどうかを確かめるようにする。"	
7	入力セルには入力規則を設定する	"・元データの構造が変わった場合、入力規則を決めずに入力すると意図していないデータを参照することが起こりうる。
・入力規則を定めることで上記のような事態を一定程度防ぐことが出来る。"		"・日付は日付型のみ許可、数値は上下限を設定、区分はドロップダウンにする。必要に応じてエラーメッセージを記載する。
・ドロップダウンは別シートのマスタ表で管理し、更新はマスタのみ変更する。"	
8	重要なシートは保護する	・意図せずに算式の変更や、行・列の挿入削除が起こることで、誤った計算をしてしまうため、シートを保護する。		・計算シート、出力シートは保護をして入力シートのみ編集可能にする。	
9	条件付き書式で異常値・欠損を可視化する。	大量データでは目視チェックに限界がある。条件付き書式で閾値超過やエラーを色分けすれば、誰でも同じ基準で異常を発見でき、レビューの着眼点が揃う。発見の早さが原因切り分けと再発防止を後押しする。	閾値超過や欠損を見落とし、週次・月次の集計に誤りが混入する。次工程がそのまま使用して意思決定が歪み、後戻りが大きくなる。原因特定に時間を要し、全件の再集計が必要になる恐れもある。	エラー候補列に条件付き書式を設定（ISERROR、空白、閾値超え等）。重大度に応じた段階色を用い、シート上に凡例を記載。「エラー確認」のチェック欄を設け、承認前にゼロ件確認を行う運用にする。	➡要検討
10	セルの役割に応じて色を変更する	・役割に応じて色を変えることで、入力すべき箇所、変更してはならない場所等がわかりやすくなる。		セル色は淡色基調で、入力可＝薄青、注意＝薄黄、エラー＝薄赤＋文字で「エラー」と明示。色だけに頼らずコメントやアイコンも併用し、赤は最重要に限定する。	
					
11	原則としてブック間参照を使用しない。	"・参照先ブックの構造が変わっても自動的に参照箇所が変わるわけではないため、ミスが起こりやすくなる。
・パスに依存するため、個人の環境によっては更新できないことが起こる
・更新されたか同課が明示的ではなく、更新漏れが発生しやすい"		可能な限りPower Queryやコピーでデータを取り込み、同一ブック内で完結させる。やむを得ず外部参照を使う場合は後述方針（ID14,15,16）を併用し、数を最小化。依存関係図と更新手順を文書化し、格納パスは共有ルートに統一する。	
14	参照先にはセルの名称を付ける	・参照先ブックの構造が変わっても、名前付き範囲なら意図した領域を保ちやすい。		・参照先ブックの必要箇所にセル名を指定しておき、それを参照するようにする。	
17	最終版はリンクを解除し、値貼り付けにする	・過去レポートを開いた時点で参照元が更新され、数値が変わらないようにする。		・外部ブックを参照している部分は値はりつけにする。セル以外にも入力規則やマクロなどにも外部参照のパスがないか確認する。	
18	参照資料は特定のフォルダにまとめ、サーバ名を含んだフルパス（UNCパス）で参照する	"・フォルダ移動や共有先変更が頻繁で、絶対パスは環境差でリンクが切れやすいため、相対パスにする。
・参照先ファイルが自身の管理対象外のファイルの場合、意図せず参照先ファイルが更新され、数値の再現性がなくなる。"		・参照先ブックはUNCパスで開き、参照元のセルではUNCパスで開いたブックを参照する。	
					
12	0/1フラグの意味と判定基準を明記する	・表にフラグとして0/1を記入する場合があるが、作成者以外に明確に0/1の定義がわからず誤解を生んでしまう。		"・列の説明に「0＝対象外、1＝対象」のように定義と判定基準を記載。
・可能ならTRUE/FALSEや「対象/対象外」のラベルを使用する。"	
13	セルや列の削除前に依存関係を確認する	・直接参照だけでなく、見えにくい依存関係があるので、セルを削除した場合に意図せず#REF!等のエラーが出てしまう。		"セルの参照パターンは以下の通りなので、この視点で削除予定のセルを参照していないか確認する。
①直接参照
参照先トレースで確認
②VBAで参照
マクロを用いて確認
③関数で間接的に参照（Indirect,OFFSET,INDEX,CHOOSE）
上記関数を検索して確認
④他のブックから参照
マクロを用いて確認
⑤入力規則で参照
⑥名前の定義で動的参照をしている場合"	

----------------------------------------------
関数
----------------------------------------------
No	ルール概要	ルールが必要な理由や背景	具体的な対応
2	定数・パラメータを直接セルに入力しない	"・数式内に直接定数やパラメータなどを入力すると、これらの数値に変更があった場合に更新漏れが生じ、誤った数値が算出される可能性がある。
・作成者しか数値の意味が理解できずに属人化する。"	・[パラメータ]シート（ルール〇〇参照）に必要な定数やパラメータを集約し、その数値を参照する。
8	条件分岐が3つ以上の場合はIFS関数またはSWITCH文を使用する	・IFの入れ子が深くなると、条件が評価される順序や条件成立時の処理の理解が困難になる可能性がある。	"（以下、画像で説明するのが良いかもしれない）
・ネストが4以上になる場合は、以下の方法で対応する。
①IFSを使う
B列に点数（0〜100）。評価は A：80以上、B：65以上、C：50以上、その他：D
=IFS(B2>=80,""A"", B2>=65,""B"", B2>=50,""C"", TRUE,""D"")

②SWITCHを使う
A列に区分コード（""A"",""B"",""C""）。A:国内、B:海外、C:その他、どれでもない
=SWITCH(A2, ""A"",""国内"", ""B"",""海外"", ""C"",""その他"", ""未定義"")

③表を参照する形に変える
・条件は可能な限りその他の処理を使用しない。"
9	COUNTIFS・SUMIFSの条件が多い場合は事前に条件判定の列を作成する	・多条件のCOUNTIFS/SUMIFSは読みづらく、かつ大量データでは再計算コストが高い。	・想定している条件を判定するための列を予め作成し、その列を参照して集計する。
11	VLOOKUP関数よりもXLOOKUP関数を優先して使用する	"・XLOOKUPは「左方向検索」「見つからない場合の値」「一致種別・検索方向」等、VLOOKUPよりも機能が充実しており、挙動が明確。
・VLOOKUPは列番号が構造変更に弱く、列を挿入すると参照がずれる。一方でXLOOKUPは範囲が1対1で対応するため表構造の変更に強い。"	・VLOOKUPは使用せず、XLOOKUPを使用する。その際、検索対象が存在しない場合の値も明示する。
12	大量データの検索にはINDEX+MATCH関数を使用する	"・大規模データでは、返り値と検索範囲を分けられるINDEX+MATCHが柔軟で、参照元の表に対して列・行挿入をした時の耐性がある。
・VLOOKUP使用すると列番号依存で構造変更時に大量の式修正が必要になる。検索列が最左にない表で無理に列並べ替えを行い、他の数式やマクロと競合して混乱が生じる。"	"・以下のような算式を組んでデータを検索する。
・MATCHの上位互換であるXMATCHを使用することも検討する。"
13	同一の計算を繰り返す場合はlet関数やlambda関数を使う	・同じ計算を何度も繰り返すと、意図せずブック全体の可読性を下げてしまう。	"・同一セル内で同じ計算を3回以上繰り返すとき、揮発性関数（ルール〇〇参照）を多数使用する時
let関数を用いて計算する

・複数シートの3か所以上で同じ数式を用いるとき
lambda関数を用いて計算する"
16	数式にN関数を使って式内コメントを埋め込む	"・ツールの作成直後はわかっていても、時間が経ってからどのような意図で算式を組んだのか不明になることがある。
・コメントが無い長大な式は、修正時に誤った解釈が起こりやすい。"	"・N（""文字列""）は算式上は0として処理されるので、以下のような形で使用する。

算式+N（""算式の説明文""）

・以下の場合にN（）関数を使用する。
①式が複雑な場合
（例）算式のネストが4以上、lambda関数を使用、４つ以上の関数を使用

②間接参照を使用する場合
（例）vlookup、offset、Indirect等を使用

③外部参照
（例）4シート以上から参照して計算、別のブックを参照

・上記の「算式」部分が文字列の場合は「文字列+0」となって、エラーになるので、N関数は使用しない"
18	配列は動的配列（スピル）を優先。従来CSE配列（Ctrl+Shift+Enter）は新規作成禁止	"動的配列は参照元のサイズの変化に応じて出力先のサイズも変更される。一方で、CSE配列は参照元が変わっても出力先のサイズは変化しない。そのため、本来の配列の一部のみ更新してしまうような事が起こりうる。
"	"以下の方法で動的配列を使用する。
①参照先をテーブルにする（ルール〇〇参照）
②以下の関数を使用する。
・条件で行を抽出➡Filter関数
・重複を除く➡Unique関数
・縦方向にデータを結合➡Vstack関数
・横方向にデータを結合➡Hstack関数"
23	Indirect、Offsetは多用しない	"・Indirect、Offsetはボラタイル関数であり、関数に関係がない部分での算式の変更でも再計算されるため、ツールが重くなる
・Indirectは参照先トレースがしにくい、シート名・セル番地の変更で参照先が変わる等の特徴もあり、意図しない計算や可読性の低下を起こしうる。"	"・ボラタイル関数ではない、Index・Matchを使用して表からのデータ抽出を行う。
・列の選択はXmatchや、Xlookup等の使用も検討する。"
26	IFERRORは多用しない	IFERRORはあらゆるエラーを丸め込むため、原因の異なるエラーを一律に同じ値へ置換してしまう。そのため、気づくべきエラーでも気づかない可能性がある。	"・特定のエラーが想定される場合にはif等を使用することで、個々の対応をする。
・Iferrorを使用せざる負えない場合は、IFERROR(式, ""【要確認】未検出"")のようにコメントを残す"
			
-----------------------------------------------
VBA
-----------------------------------------------
No	ルール概要	ルールが必要な理由や背景	具体的な対応
	OpenEpilicitをモジュールに挿入する	OpenExplicitは入れることで変数の宣言が強制され、デバックがしやすくなる。	ー
1	プロシージャ冒頭にコメントで概要等を記載する	コードの意図が明確になり、可読性が向上する。	"以下ののような形で記載する
'=========================================
' 名前    : CopyVisibleRows (Sub)
' 目的    : フィルターで可視の行だけをOutputシートに転記し列幅を自動調整
' 引数    : src As ListObject - 入力表（必須）例: Sheet1のtblSales
'         : dst As Range      - 出力左上セル（必須）例: Sheet2!A1
' 戻り値  : （Subのため無し）
' 変更履歴: 2025-10-25 名前
'========================================="
2	複雑な処理にインラインコメントを追加する	コードの意図を明確にし、可読性の向上と誤認識の回避ができる。	"・コメントを入れる場所は一連の処理の間に入れる（ルール〇〇を参照）
・処理内容のみではなく、その処理をする理由も記載する。"
2	インデントを一貫して4スペースで適用し、グループ間で空白行を入れる	"・コードの階層構造を視覚的に明確にすることで、可読性を上げる。
・インデントが統一されないことでネスト構造が不明瞭になり、If文等の誤解釈が起きる。"	"・インデントを入れる例
プロシージャ全体
繰り返し処理の関数（For、Do、While等）
Withブロック
・空行はモジュール内ではOpenExplicit（ルール〇〇参照）の後、プロシージャの間に入れる。プロシージャ内では一連の処理の間に入れる。
・対応前後の例

（対応前）
Sub Calc()
Dim i As Long
Dim s As Double
If Not rng Is Nothing Then
For i = 1 To rng.Count
If IsNumeric(rng.Cells(i).Value) Then s = s + rng.Cells(i).Value
Next i
ws.Range(""B1"").Value = s
End Sub

（対応後）
Sub Calc()
    Dim i As Long
    Dim s As Double

    If rng Is Nothing Then
        MsgBox ""範囲が未指定""
        Exit Sub
    End If

    For i = 1 To rng.Count
        If IsNumeric(rng.Cells(i).Value) Then
            s = s + rng.Cells(i).Value
        End If
    Next i

    ws.Range(""B1"").Value = s
End Sub"
3	変数名はハンガリアン記法、キャメルケースで命名	"・変数の型や内容を視覚的に識別し、チーム共有時の読みやすさを確保する。
・型が不明瞭でIntegerとLongの混同が発生し、大量データ処理でオーバーフローエラーが起きる等の型の誤認識によるエラーを避ける。"	"【一般的な定義】
（ハンガリアン記法）
変数名やクラス名などの識別子に特別な接頭文字ないし接尾文字をつけることで、他の人がその識別子を見たときに識別子の使用方法・データ型情報・スコープなどが分かるようにするための命名法。
（キャメルケース）
最初の単語は小文字、続く単語の先頭文字を大文字にする形式。
【部内奨励ルール】
ハンガリアン記法として変数の型に応じて以下の接頭文字をつける。例えば以下の通り。
String：str-
Long：lng-
Workbook：wb-
Worksheet：ws-
Range：rng-
全体としてキャメルケースを用いて、2語～4語で構成する。

（ルールに沿った例）
・strOutputFilePath：出力先ファイルパス
・rngInputData：インプットデータの範囲
・wsReportSummary：サマリーシート

（NG例）
・name：抽象的過ぎて何が格納されているのか一見して不明
・strMonthlyRiskSummaryTitleText：長すぎて可読性低下、タイポの増加
・str_report_path：キャメルケースではなく、スネークケースになっている
"
4	プロシージャ名を動詞+名詞のパスカルケースで命名	何を行うプロシージャなのかということを一見してわかるようにし、可読性を上げる	"【一般的な定義】
（パスカルケース）
すべての単語の先頭文字を大文字にする形式。
【部内奨励ルール】
動詞+名詞を基本的ルールとして命名
（例）
CalcMarketRisk：市場リスクの計算を目的としたプロシージャ
ExportTradeData：取引データの出力を目的としたプロシージャ"
5	マジックナンバーは使用禁止。	・マジックナンバーを使用することで更新漏れなどが生じる。	Referenceシート（ルール〇〇）に定数を記載し、VBA内で使用する際はそのセルを読み込む形にする。
6	大きすぎるプロシージャはいくつかのプロシージャに分割する	大規模にするとデバッグを難しくし、属人化を招く	
7	オブジェクト参照を完全に修飾し、With ... End Withを活用する	"・アクティブシート依存が近ミスを生むため、参照を明確にし、可読性と実行効率を両立
・参照が不明確でアクティブシートが変わると誤データ操作が発生し、報告書の誤りを引き起こす"	Worksheets("Data").Range("A1")のようにシート名を明示的に指定し、2回以上同オブジェクトに触れるときはWithを使用

------------------------------------------
パワークエリ
------------------------------------------
列1	No	ルール概要	ルールが必要な理由や背景	ルールがない場合に引き起こされるミス	具体的な対応	列2
●	4	Mコードにコメント記載<br>M言語のコード内に複雑な処理や重要な前提についてコメントを書くこと。	コード中のコメントは変換ロジックの意図を記録する手段であり、作成者の思考過程を後から参照可能にする[8]。将来の自分や他メンバーがクエリを理解・修正する際に役立ち、変更による不具合を防止する効果がある。	コメントが無いと、なぜその処理が必要か判断できずに削除・変更してしまう恐れがある。特にリスク管理業務では、前提を誤解した修正は計算結果の不整合を招きかねない。またコード自体も読みづらくなり、レビュー時に重要な見落としが発生するリスクが高まる。	シングルラインコメント (//) や ブロックコメント (/* */) を用いて、難解な式の意図やフィルター条件の根拠を記述する[8]。例えば「// 上限値を超える異常値を除外」とコメントすれば、後から見ても判断理由が明確になる。特にカスタム列の計算式や一見複雑なステップの前にはコメントを残す習慣を徹底する。	共通の項目にする
●	5	ハードコーディング禁止<br>ファイルパスや閾値など可変値をMコード中に直接記述しないこと。	値を直接コード内に埋め込むと柔軟性が失われ、ソース変更時に毎回コード修正が必要になる[9]。ミス防止とメンテナンス性向上のため、変更箇所を一箇所に集約すべきである。	パスや閾値を複数のクエリで直書きしていると、データ更新元が変わった際に一部のクエリだけ修正漏れし、古いデータを参照するといったミスが起こり得る。またコード修正作業自体が煩雑になり、誤って別の部分を壊すリスクも高まる。	パラメーターや変数を活用して可変値を管理する[9]。例えばファイルパスはパラメーター「p_FilePath」を作成してそこに設定し、クエリ内ではそのパラメーターを参照する。またMコードの先頭でThreshold = 0.05,のように変数定義し、それを式中で使う。こうすることで値を変更する際はパラメーター編集またはコード冒頭の1箇所修正で済むようにする。	共通の項目にする
●	6	命名規則と大文字小文字統一<br>クエリ・ステップ・変数名は一貫した命名規則で定義し、M言語の大文字小文字を区別する性質に留意すること。	チームで統一した命名スタイルを使うことでコードの可読性が上がり、異なる担当者間でも理解しやすくなる。またM言語では名前の大文字小文字が厳密に区別されるため、統一しておかないと思わぬエラーの原因になる[10]。	規則なしに名前を付けると、類似した名前の別オブジェクトを誤って参照する事故が起こり得る（例：「Rate」と「rate」は別物）。また担当者ごとに表記ゆれがあるとコード全体が読みにくくなり、保守時に誤解を招いて修正ミスに発展する可能性がある。	命名はCamelCase（例：CustomerData）、スネークケース（例：customer_data）などルールを定め全員が踏襲する。特にM言語は大文字小文字が厳密なため、既存名を利用する際は綴りと大小を正確に一致させること。「売上集計」と「売上集計_TMP」のように用途が分かる補足や、英数字の表記揺れも統一し、コード検索時に確実にヒットするよう配慮する。	共通の項目にする
複雑	27	 複雑処理は分割<br>一度に複数の操作を行わず、段階を分けてシンプルなステップを積み重ねること。 	 処理を小さなステップに分解すれば各段階で結果を確認でき、不具合の局所化が可能になる[34]。また一つ一つのステップ名で何をしているか説明しやすくなるため、クエリ全体の読みやすさ・デバッグのしやすさが向上する。 	 例えば一つのカスタム列式の中に複数の条件変換や計算を詰め込むと、どこで誤りが生じたか発見しづらい。また次の担当者がその複雑な処理を理解できずに改変を躊躇・放棄してしまい、ブラックボックス化する恐れもある。結果としてメンテ不能なクエリになりかねない。 	 UI操作で追加されるステップを活用し、1ステップ＝1目的になるよう心がける。条件分岐→計算→文字連結のような処理も、ステップを分けてそれぞれ実行させる。[34]M言語でカスタム式を書く場合も、一度に書かずlet ... in内で変数をいくつか定義し、段階的に複雑な値を組み立てる。例えば「当年売上」「前年売上」を別ステップで計算し、最後に差分を求めるようにすれば検証も容易である。 	 
●	47	 Mコードの整形<br>高度な編集を行ったM言語のコードはインデントや改行を整理し、可読性を高めること。 	 フォーマットの整ったコードは構造が把握しやすくミスを発見しやすい。逆に雑然としたコードは括弧や区切りの対応を見落としがちで、バグを産み込みやすい。特にチームでレビューする際に整形済みであれば指摘もしやすくなり、品質向上に資する。 	 インデントが無かったり不統一だと、ネストが深い処理で対応するendや括弧の位置を誤認する恐れがある。その結果、意図しない箇所で計算されたり、気付かず余分なカンマを入れてエラーになるなどのミスが起こる。また他人が読んだ時に理解に時間がかかり、レビュー漏れ・修正漏れのリスクが高まる。 	 Power Queryエディタには自動整形機能は限定的だが、手動でコードを整理する。具体的には、let内の各ステップを改行して見やすく並べ、ネストするif文やTable.TransformColumns内のラムダ式などはタブで字下げする。不要になったコード行は削除またはコメントアウトし、意味のまとまりごとに空行を入れる。コード整形後は一度実行して動作確認を行い、整形によるミスがないか確認する。 	データ加工
複雑	53	フィルターは早い段階で適用する	不要なデータを早期に除外することでプレビューが高速になり、コネクターの折り返し処理も活用できる。	後からフィルターすると大量のデータを読み込んで捨てるため、作業が遅くファイルが肥大化する。	読み込み直後に必要な列や行の条件でフィルターを設定する。	データ加工
●		M言語内での処理は列と行の選択のみにする				
●		落としたテーブルに数式を挿入する際は色を分ける				
●	30	 出力データを直接編集しない<br>Power Queryが出力したテーブル（結果データ範囲）をExcel上で手動で変更・上書きしないこと。 	 出力テーブルはクエリの更新時に再生成され元に戻るため、手入力で修正しても永続化されない。手作業で変更するとデータの真正性が損なわれ、トラブルシューティングも困難になる。常にクエリ手順から再現可能な状態を維持することが正確性・透明性の観点で重要。 	 出力を手修正してしまうと、次回Refresh時に元の値に戻り「修正が消えた」と混乱したり、場合によってはユーザーが編集したセルがクエリ更新エラーを引き起こす場合もある（出力テーブルに結合された計算列など）。またその手修正を他メンバーが知らないと、整合性の取れない報告がチーム内で作成されるリスクもある。 	 出力先シートは基本的に読み取り専用とみなす。どうしても個別調整が必要な場合は、出力テーブルとは別に列を設け参照する、またはPower Query側でその調整を組み込む。例えば、特定レコードを強制的にゼロにする必要があるなら、クエリに条件付きロジックを追加して対応する。Excel側では計算や書式設定のみ行い、データ部分は自動更新に任せる運用を徹底する。 	 
●		データはできるだけSQLで読み込む				

------------------------------------------------------
その他
------------------------------------------------------
ルール33：ファイルサイズの管理
○ルール概要
ファイルサイズが10MBを超える場合は、不要なシート・データの削除、画像の圧縮、計算方法の見直し等によりサイズ削減を実施し、動作の安定性を確保する。
○ルールが必要な理由や背景
大きなファイルサイズは処理速度の低下、フリーズ、ファイル破損のリスクを高める。リスク管理業務では安定したファイル動作が必須であり、適切なサイズ管理により業務継続性を確保できる。また、メール添付やネットワーク共有時の制約も考慮する必要がある。
○ルールがない場合に引き起こされるミス
ファイルが重すぎて動作が不安定になり、業務効率が低下する。ファイル破損により重要なデータを失う。共有時に制約が生じる。
○具体的な対応
定期的に「ファイル」→「情報」→「プロパティ」でファイルサイズを確認する。不要な書式設定のクリア、未使用行・列の削除、画像の圧縮（「図の圧縮」機能）を実施する。10MB超過の場合はデータの分割やピボットテーブルキャッシュの削除を検討する。

トラストセンターでの個人情報の削除


