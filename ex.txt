# -*- coding: utf-8 -*-
"""
Created on Sat Dec 26 12:40:14 2020

@author: wataru
"""
#パッケージのインポート
import os
import pandas as pd

#%% データのインプット
#インプットデータのファイルを指定
input_data_path = "C:/Users/ai199/Desktop/wataru/年末年始の作業/EVの作業/input.csv"
#アウトプットデータを出力するディレクトリを指定
output_directory_path = "C:/Users/ai199/Desktop/wataru/年末年始の作業/EVの作業/"
#出力するシナリオ種類を選択（csv上の列数を書く．（例）Bなら2）
output_sinerio = [4,6,10,12]

#%% 使用するデータの読み込み及び整形
#データの読み込み
all_data = pd.read_csv(input_data_path)
#必要な列のみ抽出し，整形
sinerios_number = [i+1 for i in range(5000)]
times = [i for i in range(721)]
time_Sinerios = []

for i in output_sinerio:
    #必要なデータの取り出し
    use_data = all_data.iloc[:,i-1]
    #行がシナリオ，列が時間のdfに変換
    sinarios = []
    for j in range(5000):
        one_sinario_data = use_data[721*j:721*(j+1)].values.tolist()
        sinarios.append(one_sinario_data)
    time_Sinerios.append(pd.DataFrame(sinarios,index = sinerios_number,columns = times)) 
#%% 結果の算出及び保存
colnames = all_data.columns.tolist()
for i in range(len(output_sinerio)):
    file_path = output_directory_path+"各種統計値_"+"{a}".format(a = colnames[output_sinerio[i]-1])+".csv"
    time_Sinerios[i].describe().to_csv(file_path)


